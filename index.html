<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Sudan Displacement Dashboard</title>
  
  <!-- External CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary-color: #4361ee;
      --primary-light: #eef2ff;
      --secondary-color: #f72585;
      --secondary-light: #fff0f6;
      --tertiary-color: #4cc9f0;
      --success-color: #2ecc71;
      --warning-color: #f39c12;
      --light-gray: #f8fafc;
      --medium-gray: #e2e8f0;
      --dark-gray: #64748b;
      --darker-gray: #334155;
      --border-radius: 12px;
      --border-radius-sm: 8px;
      --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      --header-height: 70px;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f1f5f9;
      height: 100vh;
      overflow: hidden;
    }

    .app-header {
      background-color: white;
      padding: 0 20px;
      box-shadow: var(--box-shadow);
      height: var(--header-height);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .app-title {
      font-size: 1.3rem;
      color: var(--primary-color);
    }
    
    .main-container {
      display: flex;
      height: calc(100vh - var(--header-height));
    }
    
    .sidebar-content {
      width: 380px;
      background-color: white;
      padding: 15px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .dashboard-section {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      overflow: hidden;
    }
    
    .section-header {
      padding: 12px 15px;
      background: var(--light-gray);
      border-bottom: 1px solid var(--medium-gray);
      display: flex;
      justify-content: space-between;
    }
    
    .section-title {
      font-size: 1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .section-content {
      padding: 15px;
    }
    
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }
    
    .metric-card {
      background: var(--light-gray);
      border-radius: var(--border-radius-sm);
      padding: 12px;
      text-align: center;
    }
    
    .metric-card .value {
      font-size: 20px;
      font-weight: 700;
      margin: 5px 0;
    }
    
    .idps-metric {
      border-top: 3px solid var(--primary-color);
    }
    
    .idps-metric .value {
      color: var(--primary-color);
    }
    
    .returnees-metric {
      border-top: 3px solid var(--secondary-color);
    }
    
    .returnees-metric .value {
      color: var(--secondary-color);
    }
    
    .crossing-metric {
      border-top: 3px solid var(--tertiary-color);
    }
    
    .crossing-metric .value {
      color: var(--tertiary-color);
    }
    
    .flow-direction {
      display: flex;
      justify-content: space-around;
      margin-top: 10px;
      padding: 10px;
      background: var(--light-gray);
      border-radius: var(--border-radius-sm);
    }
    
    .flow-item .value {
      font-size: 16px;
    }
    
    .chart-container {
      height: 200px;
      margin-top: 10px;
    }
    
    .map-container {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }
    
    #population-distribution-map,
    #flow-map {
      flex-grow: 1;
      width: 100%;
    }
    
    .map-controls {
      padding: 10px 15px;
      background-color: white;
      border-bottom: 1px solid var(--medium-gray);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    /* Ensure data appears */
    .metric-card, .chart-container {
      min-height: 120px;
    }
    
    @media (max-width: 768px) {
      .sidebar-content {
        width: 320px;
        padding: 10px;
      }
      
      .metrics-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <header class="app-header">
    <h1 class="app-title">Sudan Displacement Dashboard</h1>
  </header>
  
  <div class="main-container">
    <div class="sidebar-content">
      <!-- IDPs Section -->
      <div class="dashboard-section">
        <div class="section-header">
          <h2 class="section-title">
            <i class="fas fa-people-arrows"></i> IDPs
          </h2>
        </div>
        <div class="section-content">
          <div class="metrics-grid">
            <div class="metric-card idps-metric">
              <div class="label">Total IDPs</div>
              <div class="value">9.84M</div>
            </div>
            <div class="metric-card">
              <div class="label">New This Month</div>
              <div class="value">1.05M</div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Returnees Section -->
      <div class="dashboard-section">
        <div class="section-header">
          <h2 class="section-title">
            <i class="fas fa-home"></i> Returnees
          </h2>
        </div>
        <div class="section-content">
          <div class="metrics-grid">
            <div class="metric-card returnees-metric">
              <div class="label">Total Returnees</div>
              <div class="value">647K</div>
            </div>
            <div class="metric-card">
              <div class="label">New This Month</div>
              <div class="value">32K</div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Population Movement Section -->
      <div class="dashboard-section">
        <div class="section-header">
          <h2 class="section-title">
            <i class="fas fa-exchange-alt"></i> Population Movement
          </h2>
        </div>
        <div class="section-content">
          <div class="metric-card crossing-metric">
            <div class="label">Total Crossings</div>
            <div class="value">1.24M</div>
            <div class="flow-direction">
              <div class="flow-item">
                <div class="label">Inflow</div>
                <div class="value">842K</div>
              </div>
              <div class="flow-item">
                <div class="label">Outflow</div>
                <div class="value">403K</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Trends Section -->
      <div class="dashboard-section">
        <div class="section-header">
          <h2 class="section-title">
            <i class="fas fa-chart-line"></i> Trends
          </h2>
        </div>
        <div class="section-content">
          <div class="chart-container">
            <canvas id="trendChart"></canvas>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Map container -->
    <div class="map-container">
      <div class="map-controls">
        <h2 class="map-title">
          <i class="fas fa-map-marked-alt"></i> Population Map
        </h2>
      </div>
      <div id="population-distribution-map"></div>
    </div>
  </div>

  <!-- JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  
  <script>
    // Initialize Chart
    const ctx = document.getElementById('trendChart').getContext('2d');
    const trendChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['Jan', 'Feb', 'Mar', 'Apr'],
        datasets: [
          {
            label: 'IDPs',
            data: [7000000, 8000000, 8500000, 9200000],
            borderColor: '#4361ee',
            backgroundColor: 'rgba(67, 97, 238, 0.1)',
            borderWidth: 2,
            tension: 0.3
          },
          {
            label: 'Returnees',
            data: [500000, 550000, 600000, 620000],
            borderColor: '#f72585',
            backgroundColor: 'rgba(247, 37, 133, 0.1)',
            borderWidth: 2,
            tension: 0.3
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'bottom'
          }
        }
      }
    });

    // Initialize Map
    const map = L.map('population-distribution-map').setView([15, 30], 6);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // Sample data points
    const locations = [
      { lat: 15.5, lng: 32.5, name: "Khartoum", value: 1200000 },
      { lat: 13.5, lng: 25.5, name: "Darfur", value: 1800000 },
      { lat: 14.5, lng: 33.5, name: "Kassala", value: 500000 }
    ];

    locations.forEach(loc => {
      L.circleMarker([loc.lat, loc.lng], {
        radius: Math.sqrt(loc.value) / 300,
        fillColor: "#4361ee",
        color: "#fff",
        weight: 1,
        opacity: 1,
        fillOpacity: 0.7
      }).addTo(map).bindPopup(`${loc.name}<br>${loc.value.toLocaleString()} IDPs`);
    });
  </script>
</body>
</html>
